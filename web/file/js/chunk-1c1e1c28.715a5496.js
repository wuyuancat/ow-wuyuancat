(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c1e1c28","chunk-e021d7b4"],{"1c90":function(e,t,a){},"41ba":function(e,t,a){"use strict";a("1c90")},"78eb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tenant-config-pannel"},[a("a-form",{attrs:{slot:"detail",form:e.form},slot:"detail"},[a("a-tabs",[a("a-button",{attrs:{slot:"tabBarExtraContent",type:"primary"},on:{click:e.saveCurrentConfig},slot:"tabBarExtraContent"},[e._v("保存")]),a("a-tab-pane",{key:"concat",attrs:{tab:"基本信息",forceRender:""}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"联系人",labelCol:e.labelCol2,wrapperCol:e.wrapperCol2}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["_linkman"],expression:"['_linkman']"}],attrs:{placeholder:"请输联系人"}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"联系手机",labelCol:e.labelCol2,wrapperCol:e.wrapperCol2}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["_phone"],expression:"['_phone']"}],attrs:{placeholder:"请输入手机号"}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"地址",labelCol:e.labelCol2,wrapperCol:e.wrapperCol2}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["_address"],expression:"['_address']"}],attrs:{placeholder:"请输入地址"}})],1)],1)],1)],1),a("a-tab-pane",{key:"base",attrs:{tab:"网站配置",forceRender:""}},[a("a-row",{attrs:{type:"flex",justify:"space-between"}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"品牌名",labelCol:e.labelCol2,wrapperCol:e.wrapperCol2}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["brandName",e.validatorRules.brandName],expression:"['brandName', validatorRules.brandName]"}],attrs:{placeholder:"请输入品牌名称"}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"品牌简介",labelCol:e.labelCol2,wrapperCol:e.wrapperCol2}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["brandDesc",e.validatorRules.brandDesc],expression:"['brandDesc', validatorRules.brandDesc]"}],attrs:{placeholder:"请输入品牌简介"}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"LOGO",labelCol:e.labelCol2,wrapperCol:e.wrapperCol2}},[a("j-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["logo",e.validatorRules.logo],expression:"['logo', validatorRules.logo]"}],attrs:{uploadTarget:"qiniu",fileType:"image",number:1,"trigger-change":!0}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"底部文字",labelCol:e.labelCol2,wrapperCol:e.wrapperCol2}},[a("j-editor",{directives:[{name:"decorator",rawName:"v-decorator",value:["footer"],expression:"['footer']"}],attrs:{triggerChange:!0}})],1)],1)],1)],1),a("a-tab-pane",{key:"func",staticStyle:{"min-height":"200px"},attrs:{tab:"功能配置",forceRender:""}},[a("a-row",[a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"开放注册",labelCol:{xs:{span:12},sm:{span:10}},wrapperCol:{xs:{span:12},sm:{span:14}}}},[a("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["allowReg",{initialValue:"0"}],expression:"['allowReg', { initialValue: '0' }]"}],attrs:{type:"radioButton","trigger-change":!0,dictCode:"yn",placeholder:"请选择是否开放注册"},on:{change:function(t){return e.model.allowReg=t.target.value}}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-item",{attrs:{label:"默认注册角色",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["_defaultRole"],expression:"[ '_defaultRole']"}],attrs:{disabled:"1"!=e.model.allowReg,triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"请选择角色"}})],1)],1),a("a-col",{attrs:{span:10}},[a("a-form-item",{attrs:{label:"默认注册班级",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("j-select-depart",{attrs:{disabled:"1"!=e.model.allowReg,multi:!1},model:{value:e.model._defaultDepart,callback:function(t){e.$set(e.model,"_defaultDepart",t)},expression:"model._defaultDepart"}})],1)],1)],1)],1)],1)],1)],1)},i=[],r=(a("88bc"),a("0fea")),s=a("cf74"),o=a("c010"),l=a("fe54"),c=a("a061"),u={name:"TenantConfig",components:{JUpload:s["default"],JSearchSelectTag:o["default"],JSelectDepart:l["default"],JEditor:c["default"]},data:function(){return{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}},labelCol2:{xs:{span:24},sm:{span:3}},wrapperCol2:{xs:{span:24},sm:{span:20}},form:this.$form.createForm(this),validatorRules:{theme:{rules:[{required:!0,message:"请选择主题!"}]},brandName:{rules:[{required:!0,message:"请输入品牌名!"}]},logo:{rules:[{required:!1,message:"请上传LOGO!"}]}},tenantInfo:{},model:{}}},created:function(){this.getCurrentConfig()},methods:{getCurrentConfig:function(){var e=this;Object(r["c"])("/sys/config/getAllConfigList").then((function(t){t.success?(t.result.map((function(t){e.model[t.configKey]=t.configValue})),e.$nextTick((function(){e.form.setFieldsValue(e.model)}))):e.$message.warning(t.message)}))},saveCurrentConfig:function(){var e=this;this.form.validateFields((function(t,a){if(!t){var n=Object.assign(e.model,a);for(var i in n)void 0===n[i]&&(n[i]="");Object(r["k"])("/sys/config/saveTenantConfig",n).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok"),e.visible=!1):e.$message.warning(t.message)}))}}))}}},d=u,h=(a("41ba"),a("2877")),p=Object(h["a"])(d,n,i,!1,null,"7cfac462",null);t["default"]=p.exports},"7ab5":function(e,t,a){},"88bc":function(e,t,a){(function(t){var a=1/0,n=9007199254740991,i="[object Arguments]",r="[object Function]",s="[object GeneratorFunction]",o="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")();function d(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function h(e,t){var a=-1,n=e?e.length:0,i=Array(n);while(++a<n)i[a]=t(e[a],a,e);return i}function p(e,t){var a=-1,n=t.length,i=e.length;while(++a<n)e[i+a]=t[a];return e}var f=Object.prototype,m=f.hasOwnProperty,v=f.toString,g=u.Symbol,y=f.propertyIsEnumerable,b=g?g.isConcatSpreadable:void 0,w=Math.max;function C(e,t,a,n,i){var r=-1,s=e.length;a||(a=S),i||(i=[]);while(++r<s){var o=e[r];t>0&&a(o)?t>1?C(o,t-1,a,n,i):p(i,o):n||(i[i.length]=o)}return i}function k(e,t){return e=Object(e),x(e,t,(function(t,a){return a in e}))}function x(e,t,a){var n=-1,i=t.length,r={};while(++n<i){var s=t[n],o=e[s];a(o,s)&&(r[s]=o)}return r}function O(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,n=-1,i=w(a.length-t,0),r=Array(i);while(++n<i)r[n]=a[t+n];n=-1;var s=Array(t+1);while(++n<t)s[n]=a[n];return s[t]=r,d(e,this,s)}}function S(e){return L(e)||j(e)||!!(b&&e&&e[b])}function D(e){if("string"==typeof e||F(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function j(e){return _(e)&&m.call(e,"callee")&&(!y.call(e,"callee")||v.call(e)==i)}var L=Array.isArray;function I(e){return null!=e&&N(e.length)&&!A(e)}function _(e){return K(e)&&I(e)}function A(e){var t=T(e)?v.call(e):"";return t==r||t==s}function N(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function T(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function K(e){return!!e&&"object"==typeof e}function F(e){return"symbol"==typeof e||K(e)&&v.call(e)==o}var P=O((function(e,t){return null==e?{}:k(e,h(C(t,1),D))}));e.exports=P}).call(this,a("c8ba"))},9884:function(e,t,a){"use strict";a("9dfd")},"9dfd":function(e,t,a){},b0cd:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"选择部门",width:e.modalWidth,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{tip:"Loading...",spinning:!1}},[a("a-input-search",{staticStyle:{"margin-bottom":"1px"},attrs:{placeholder:"请输入部门名称按回车进行搜索"},on:{search:e.onSearch}}),a("a-tree",{attrs:{checkable:"",treeData:e.treeData,checkStrictly:!0,autoExpandParent:e.autoExpandParent,expandedKeys:e.expandedKeys,checkedKeys:e.checkedKeys},on:{check:e.onCheck,select:e.onSelect,expand:e.onExpand},scopedSlots:e._u([{key:"title",fn:function(t){var n=t.title;return[n.indexOf(e.searchValue)>-1?a("span",[e._v("\n          "+e._s(n.substr(0,n.indexOf(e.searchValue)))+"\n          "),a("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.searchValue))]),e._v("\n          "+e._s(n.substr(n.indexOf(e.searchValue)+e.searchValue.length))+"\n        ")]):a("span",[e._v(e._s(n))])]}}])})],1)],1)},i=[],r=a("4ec3");function s(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=c(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,r=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw r}}}}function o(e){return d(e)||u(e)||c(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if(e){if("string"===typeof e)return h(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?h(e,t):void 0}}function u(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){if(Array.isArray(e))return h(e)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var p={name:"JSelectDepartModal",props:["modalWidth","multi","rootOpened","departId"],data:function(){return{visible:!1,confirmLoading:!1,treeData:[],autoExpandParent:!0,expandedKeys:[],dataList:[],checkedKeys:[],checkedRows:[],searchValue:""}},created:function(){this.loadDepart()},watch:{departId:function(){this.initDepartComponent()},visible:{handler:function(){this.departId?this.checkedKeys=this.departId.split(","):this.checkedKeys=[]}}},methods:{show:function(){this.visible=!0,this.checkedRows=[],this.checkedKeys=[]},loadDepart:function(){var e=this;Object(r["G"])().then((function(t){if(t.success){var a=o(t.result);e.reWriterWithSlot(a),e.treeData=a,e.initDepartComponent(),e.rootOpened&&e.initExpandedKeys(t.result)}}))},initDepartComponent:function(){var e="";if(this.departId){var t,a=this.departId,n=s(this.dataList);try{for(n.s();!(t=n.n()).done;){var i=t.value;a.indexOf(i.key)>=0&&(e+=","+i.title)}}catch(r){n.e(r)}finally{n.f()}e&&(e=e.substring(1))}this.$emit("initComp",e)},reWriterWithSlot:function(e){var t,a=s(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.children&&n.children.length>0){this.reWriterWithSlot(n.children);var i=Object.assign({},n);i.children={},this.dataList.push(i)}else this.dataList.push(n),n.scopedSlots={title:"title"}}}catch(r){a.e(r)}finally{a.f()}},initExpandedKeys:function(e){if(e&&e.length>0){var t,a=[],n=s(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.children&&i.children.length>0&&a.push(i.id)}}catch(r){n.e(r)}finally{n.f()}this.expandedKeys=[].concat(a)}else this.expandedKeys=[]},onCheck:function(e,t){var a=this;if(this.multi)this.checkedKeys=e.checked,this.checkedRows=this.getCheckedRows(this.checkedKeys);else{var n=e.checked.filter((function(e){return a.checkedKeys.indexOf(e)<0}));this.checkedKeys=o(n),this.checkedRows=0===this.checkedKeys.length?[]:[t.node.dataRef]}},onSelect:function(e,t){var a=[];if(a.push(e[0]),this.checkedKeys&&0!==this.checkedKeys.length&&this.multi){var n,i=t.node.dataRef.key;if(this.checkedKeys.indexOf(i)>=0)this.checkedKeys=this.checkedKeys.filter((function(e){return e!==i}));else(n=this.checkedKeys).push.apply(n,a)}else this.checkedKeys=[].concat(a),this.checkedRows=[t.node.dataRef];this.checkedRows=this.getCheckedRows(this.checkedKeys)},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},handleSubmit:function(){this.checkedKeys&&0!=this.checkedKeys.length?this.$emit("ok",this.checkedRows,this.checkedKeys.join(",")):this.$emit("ok",""),this.handleClear()},handleCancel:function(){this.handleClear()},handleClear:function(){this.visible=!1,this.checkedKeys=[]},getParentKey:function(e,t){for(var a,n=0;n<t.length;n++){var i=t[n];i.children&&(i.children.some((function(t){return t.key===e}))?a=i.key:this.getParentKey(e,i.children)&&(a=this.getParentKey(e,i.children)))}return a},onSearch:function(e){var t=this,a=this.dataList.map((function(a){return a.title.indexOf(e)>-1?t.getParentKey(a.key,t.treeData):null})).filter((function(e,t,a){return e&&a.indexOf(e)===t}));Object.assign(this,{expandedKeys:a,searchValue:e,autoExpandParent:!0})},getCheckedRows:function(e){var t,a=function e(t,a){var n,i=s(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.id===a)return r;if(r.children instanceof Array){var o=e(r.children,a);if(null!=o)return o}}}catch(l){i.e(l)}finally{i.f()}return null},n=[],i=s(e);try{for(i.s();!(t=i.n()).done;){var r=t.value,o=a(this.treeData,r);null!=o&&n.push(o)}}catch(l){i.e(l)}finally{i.f()}return n}}},f=p,m=a("2877"),v=Object(m["a"])(f,n,i,!1,null,"4907a211",null);t["default"]=v.exports},c010:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.async?a("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",labelInValue:"",disabled:e.disabled,getPopupContainer:function(e){return e.parentNode},placeholder:e.placeholder,filterOption:!1,allowClear:"",notFoundContent:e.loading?void 0:null},on:{search:e.loadData,change:e.handleAsyncChange},model:{value:e.selectedAsyncValue,callback:function(t){e.selectedAsyncValue=t},expression:"selectedAsyncValue"}},[e.loading?a("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.options,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.text))])}))],2):a("a-select",{staticStyle:{width:"100%"},attrs:{getPopupContainer:function(e){return e.parentNode},showSearch:"",disabled:e.disabled,placeholder:e.placeholder,optionFilterProp:"children",filterOption:e.filterOption,allowClear:"",notFoundContent:e.loading?void 0:null},on:{change:e.handleChange},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},[e.loading?a("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.options,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.text))])}))],2)},i=[],r=a("4ec3"),s=a("b047"),o=a.n(s),l=a("0fea");function c(e){return p(e)||h(e)||d(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){if(e){if("string"===typeof e)return f(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(e,t):void 0}}function h(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function p(e){if(Array.isArray(e))return f(e)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){g(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var y={name:"JSearchSelectTag",props:{disabled:Boolean,value:[String,Number],dict:String,dictOptions:Array,async:Boolean,placeholder:{type:String,default:"请选择",required:!1}},data:function(){return this.loadData=o()(this.loadData,800),this.lastLoad=0,{loading:!1,selectedValue:[],selectedAsyncValue:[],options:[]}},created:function(){this.initDictData()},watch:{value:{immediate:!0,handler:function(e){e||0==e?this.initSelectValue():(this.selectedValue=[],this.selectedAsyncValue=[])}},dict:{handler:function(){this.initDictData()}}},methods:{initSelectValue:function(){var e=this;this.async?this.selectedAsyncValue&&this.selectedAsyncValue.key&&this.selectedAsyncValue.key==this.value||Object(l["c"])("/sys/dict/loadDictItem/".concat(this.dict),{key:this.value}).then((function(t){if(t.success){var a={key:e.value,label:t.result};e.selectedAsyncValue=v({},a)}})):this.selectedValue=this.value.toString()},loadData:function(e){var t=this;this.lastLoad+=1;var a=this.lastLoad;this.options=[],this.loading=!0,Object(l["c"])("/sys/dict/loadDict/".concat(this.dict),{keyword:e}).then((function(e){if(t.loading=!1,e.success){if(a!=t.lastLoad)return;t.options=e.result}else t.$message.warning(e.message)}))},initDictData:function(){var e=this;if(!this.async)if(this.dictOptions&&this.dictOptions.length>0)this.options=c(this.dictOptions);else{var t="";if(this.dict){var a=this.dict.split(",");if(a[0].indexOf("where")>0){var n=a[0].split("where");t=n[0].trim()+","+a[1]+","+a[2]+","+encodeURIComponent(n[1])}else t=this.dict;if(-1==this.dict.indexOf(",")&&Object(r["w"])(this.dictCode))return void(this.options=Object(r["w"])(this.dictCode));Object(r["g"])(t,null).then((function(t){t.success&&(e.options=t.result)}))}}},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleChange:function(e){this.selectedValue=e,this.callback()},handleAsyncChange:function(e){this.selectedAsyncValue=e,this.selectedValue=e.key,this.callback()},callback:function(){this.$emit("change",this.selectedValue)},setCurrentDictOptions:function(e){this.options=e},getCurrentDictOptions:function(){return this.options}},model:{prop:"value",event:"change"}},b=y,w=a("2877"),C=Object(w["a"])(b,n,i,!1,null,"26caf0df",null);t["default"]=C.exports},cf74:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{position:"relative"},attrs:{id:e.containerId}},[a("div",{staticClass:"movety-container",staticStyle:{padding:"0 8px",position:"absolute","z-index":"91",height:"32px",width:"104px","text-align":"center"},style:{top:e.top+"px",left:e.left+"px",display:e.moveDisplay}},[a("div",{class:e.showMoverTask?"uploadty-mover-mask":"movety-opt",staticStyle:{"margin-top":"12px"},attrs:{id:e.containerId+"-mover"}},[a("a",{staticStyle:{margin:"0 5px"},on:{click:e.moveLast}},[a("a-icon",{staticStyle:{color:"#fff","font-size":"16px"},attrs:{type:"arrow-left"}})],1),a("a",{staticStyle:{margin:"0 5px"},on:{click:e.moveNext}},[a("a-icon",{staticStyle:{color:"#fff","font-size":"16px"},attrs:{type:"arrow-right"}})],1)])]),a("a-upload",{class:{"uploadty-disabled":e.disabled},attrs:{name:"file",multiple:e.multiple,action:e.getUploadAction(),headers:e.headers,data:e.getUploadData,fileList:e.fileList,beforeUpload:e.beforeUpload,disabled:e.disabled,returnUrl:e.returnUrl,listType:e.complistType},on:{change:e.handleChange,preview:e.handlePreview}},[[e.isImageComp?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(e._s(e.text))])],1):0==e.fileList.length||e.buttonVisible?a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(e._s(e.text)+"\n      ")],1):e._e()]],2),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)},i=[],r=a("2b0e"),s=a("9fb0"),o=a("0fea"),l="all",c="image",u="local",d="qiniu",h="oss",p="cos",f=function(){return"-"+parseInt(1e4*Math.random()+1,10)},m=function(){for(var e=[],t="0123456789abcdef",a=0;a<36;a++)e[a]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var n=e.join("");return n=n.replace(/-/g,""),n},v=function(e){if(e.lastIndexOf("\\")>=0){var t=new RegExp("\\\\","g");e=e.replace(t,"/")}return e.substring(e.lastIndexOf("/")+1)},g={name:"JUpload",data:function(){return{urlDownload:"",downloadUrl:{local:window._CONFIG["domianURL"]+"/sys/common/static/",qiniu:window._CONFIG["qn_base"]},uploadAction:{local:window._CONFIG["domianURL"]+"/sys/common/upload",qiniu:"//upload-"+window._CONFIG["qn_area"]+".qiniup.com",oss:"",cos:""},tokenAction:{qiniu:"/common/qiniu/getToken"},headers:{},fileList:[],uploadToken:"",uploadKey:"",newFileList:[],uploadGoOn:!0,previewVisible:!1,previewImage:"",containerId:"",top:"",left:"",moveDisplay:"none",showMoverTask:!1,moverHold:!1,currentImg:""}},props:{text:{type:String,required:!1,default:"点击上传"},fileType:{type:String,required:!1,default:l},uploadPath:{type:String,require:!1,default:""},fileName:{type:String,require:!1},maxFileSize:{type:Number,required:!1,default:1e3},uploadTarget:{type:String,required:!1,default:window._CONFIG["defaultUploadType"]||u},bizPath:{type:String,required:!1,default:"temp"},value:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},multiple:{type:Boolean,required:!1,default:!1},returnUrl:{type:Boolean,required:!1,default:!0},number:{type:Number,required:!1,default:0},autoDelete:{type:Boolean,required:!1,default:!0},buttonVisible:{type:Boolean,required:!1,default:!0}},watch:{value:{immediate:!0,handler:function(){var e=this.value;e instanceof Array?this.returnUrl?this.initFileList(e.join(",")):this.initFileListArr(e):this.initFileList(e)}}},computed:{isImageComp:function(){return this.fileType===c},complistType:function(){return this.fileType===c?"picture-card":"text"}},created:function(){var e=r["default"].ls.get(s["a"]);this.headers={"X-Access-Token":e},this.containerId="container-ty-"+(new Date).getTime()},methods:{getUploadAction:function(){switch(this.uploadTarget){case u:return this.uploadAction.local;case d:return this.uploadAction.qiniu;case h:return this.uploadAction.oss;case p:return this.uploadAction.cos;default:return this.uploadAction.local}},getDownloadUrl:function(e){switch(this.uploadTarget){case u:return this.downloadUrl.local+e;case d:return this.downloadUrl.qiniu+e;case h:return this.downloadUrl.oss+e;case p:return this.downloadUrl.cos+e;default:return this.uploadAction.local+e}},getUploadData:function(e){switch(this.uploadTarget){case u:return{isup:1,bizPath:this.bizPath};case d:return{token:this.uploadToken,key:this.uploadKey};case h:return{};case p:return{};default:return{isup:1,bizPath:this.bizPath}}},getQiniuToken:function(){var e=this;return new Promise((function(t,a){Object(o["c"])(e.tokenAction.qiniu,{}).then((function(n){if(n.success)return e.uploadToken=n.result,void t();e.$message.error(n.message),a()}))}))},getFileFullName:function(e){return this.uploadPath+(this.fileName?this.fileName:m())+"."+e},saveToDB:function(e,t,a,n){var i=this;return Object(o["k"])("/system/sysFile/add",{fileName:e,filePath:t,fileLocation:a,fileTag:n}).then((function(e){e.success&&i.$emit("saved",e.result)}))},delFromBD:function(e){return Object(o["a"])("/system/sysFile/deleteByPath",{filePath:e})},initFileListArr:function(e){if(e&&0!=e.length){for(var t=[],a=0;a<e.length;a++){var n=getDownloadUrl(e[a].filePath);t.push({uid:f(),name:e[a].fileName,status:"done",url:n,response:{status:"history",message:e[a].filePath}})}this.fileList=t}else this.fileList=[]},initFileList:function(e){if(e&&0!=e.length){for(var t=[],a=e.split(","),n=0;n<a.length;n++){var i=this.getDownloadUrl(a[n]);t.push({uid:f(),name:v(a[n]),status:"done",url:i,response:{status:"history",message:a[n]}})}this.fileList=t}else this.fileList=[]},handlePathChange:function(){var e=this.fileList,t="";e&&0!=e.length||(t="");for(var a=[],n=0;n<e.length;n++){if("done"!==e[n].status)return;a.push(e[n].response.message)}a.length>0&&(t=a.join(",")),this.$emit("change",t)},beforeUpload:function(e){this.uploadGoOn=!0;var t=e.type;if(this.fileType===c&&t.indexOf("image")<0)return this.$message.warning("请上传图片"),this.uploadGoOn=!1,!1;if(e.size>1024*this.maxFileSize*1024)return this.$message.warning("文件超过"+this.maxFileSize+"MB"),!1;var a=e.name.split(".");switch(a=a.length>1?a.pop():"",this.uploadKey=this.getFileFullName(a),this.$emit("selected",this.uploadKey,e),this.uploadTarget){case d:return this.getQiniuToken();default:return!0}},handleChange:function(e){var t=this;e.file.status||!1!==this.uploadGoOn||e.fileList.pop();var a=e.fileList;if(this.number>0&&a.length>this.number&&(this.handleDelete(a[0]),a=a.slice(-this.number)),"done"===e.file.status){switch(this.uploadTarget){case u:e.file.response.success&&(a=a.map((function(e){return e.response&&e.response.message&&(e.url=t.getDownloadUrl(e.response.message),t.saveToDB(e.name,e.response.message,1,"后台上传")),e})));case d:e.file.response.key&&(a=a.map((function(e){return e.response&&e.response.key&&(e.response.message=e.response.key,e.url=t.getDownloadUrl(e.response.key),t.saveToDB(e.name,e.response.key,2,"后台上传")),e})))}this.$message.success("".concat(e.file.name," 上传成功!"))}else"error"===e.file.status?this.$message.error("".concat(e.file.name," 上传失败.")):"removed"===e.file.status&&this.handleDelete(e.file);if(this.fileList=a,"done"===e.file.status||"removed"===e.file.status)if(this.returnUrl)this.handlePathChange();else{this.newFileList=[];for(var n=0;n<a.length;n++){if("done"!==a[n].status)return;var i={fileName:a[n].name,filePath:a[n].response.message,fileSize:a[n].size};this.newFileList.push(i)}this.$emit("change",this.newFileList)}},handleDelete:function(e){this.autoDelete&&this.delFromBD(e.response.message),this.$emit("delete",e.response.message)},handlePreview:function(e){this.fileType===c?(this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0):location.href=e.url},handleCancel:function(){this.previewVisible=!1},moveLast:function(){var e=this.getIndexByUrl();if(0==e)this.$message.warn("未知的操作");else{for(var t=this.fileList[e].url,a=this.fileList[e-1].url,n=[],i=0;i<this.fileList.length;i++)i==e-1?n.push(t):i==e?n.push(a):n.push(this.fileList[i].url);this.currentImg=a,this.$emit("change",n.join(","))}},moveNext:function(){var e=this.getIndexByUrl();if(e==this.fileList.length-1)this.$message.warn("已到最后~");else{for(var t=this.fileList[e].url,a=this.fileList[e+1].url,n=[],i=0;i<this.fileList.length;i++)i==e+1?n.push(t):i==e?n.push(a):n.push(this.fileList[i].url);this.currentImg=a,this.$emit("change",n.join(","))}},getIndexByUrl:function(){for(var e=0;e<this.fileList.length;e++)if(this.fileList[e].url===this.currentImg||encodeURI(this.fileList[e].url)===this.currentImg)return e;return-1}},mounted:function(){var e=this,t=document.getElementById(this.containerId+"-mover");t.addEventListener("mouseover",(function(){e.moverHold=!0,e.moveDisplay="block"})),t.addEventListener("mouseout",(function(){e.moverHold=!1,e.moveDisplay="none"}));var a=document.getElementById(this.containerId)?document.getElementById(this.containerId).getElementsByClassName("ant-upload-list-picture-card"):[];a&&a.length>0&&(a[0].addEventListener("mouseover",(function(t){t=t||window.event;var a=t.target||t.srcElement;if("ant-upload-list-item-info"==a.className){e.showMoverTask=!1;var n=a.parentElement;e.left=n.offsetLeft,e.top=n.offsetTop+n.offsetHeight-50,e.moveDisplay="block",e.currentImg=a.getElementsByTagName("img")[0].src}})),a[0].addEventListener("mouseout",(function(t){t=t||window.event;var a=t.target||t.srcElement;"ant-upload-list-item-info"==a.className&&(e.showMoverTask=!0,setTimeout((function(){!1===e.moverHold&&(e.moveDisplay="none")}),100)),"ant-upload-list-item ant-upload-list-item-done"!=a.className&&"ant-upload-list ant-upload-list-picture-card"!=a.className||(e.moveDisplay="none")})))},model:{prop:"value",event:"change"}},y=g,b=(a("de21"),a("2877")),w=Object(b["a"])(y,n,i,!1,null,null,null);t["default"]=w.exports},de21:function(e,t,a){"use strict";a("7ab5")},fe54:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-input-demo-presuffix"},[a("a-input",{attrs:{placeholder:"请点击选择部门",readOnly:"",disabled:e.disabled},on:{click:e.openModal},model:{value:e.departNames,callback:function(t){e.departNames=t},expression:"departNames"}},[a("a-icon",{attrs:{slot:"prefix",type:"cluster",title:"部门选择控件"},slot:"prefix"}),e.departIds?a("a-icon",{attrs:{slot:"suffix",type:"close-circle",title:"清空"},on:{click:e.handleEmpty},slot:"suffix"}):e._e()],1),a("j-select-depart-modal",{ref:"innerDepartSelectModal",attrs:{"modal-width":e.modalWidth,multi:e.multi,rootOpened:e.rootOpened,"depart-id":e.departIds},on:{ok:e.handleOK,initComp:e.initComp}})],1)},i=[],r=a("b0cd"),s={name:"JSelectDepart",components:{JSelectDepartModal:r["default"]},props:{modalWidth:{type:Number,default:500,required:!1},multi:{type:Boolean,default:!1,required:!1},rootOpened:{type:Boolean,default:!0,required:!1},value:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},customReturnField:{type:String,default:"id"}},data:function(){return{visible:!1,confirmLoading:!1,departNames:"",departIds:""}},mounted:function(){this.departIds=this.value},watch:{value:function(e){"id"===this.customReturnField&&(this.departIds=e)}},methods:{initComp:function(e){this.departNames=e},openModal:function(){this.$refs.innerDepartSelectModal.show()},handleOK:function(e,t){var a=this,n="";!e&&e.length<=0?(this.departNames="",this.departIds=""):(n=e.map((function(e){return e[a.customReturnField]})).join(","),this.departNames=e.map((function(e){return e["departName"]})).join(","),this.departIds=t),this.$emit("change",n)},getDepartNames:function(){return this.departNames},handleEmpty:function(){this.handleOK("")}},model:{prop:"value",event:"change"}},o=s,l=(a("9884"),a("2877")),c=Object(l["a"])(o,n,i,!1,null,"4d448922",null);t["default"]=c.exports}}]);